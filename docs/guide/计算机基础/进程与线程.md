# 进程与线程

[文章地址](https://cloud.tencent.com/developer/article/1688297)

## 是什么

### 进程

进程是对运行时程序的封装，是系统进行资源分配和调度的基本单位，实现了操作系统的并发。

### 线程

线程是进程的子任务，是 CPU 调度和分派的基本单位，用于保证程序的实时性，实现进程内部的并发；线程是操作系统可识别的最小执行和调度单位。每个线程都独自占用一个虚拟处理器；独自的寄存器组，指令计数器和处理器状态。每个线程完成不同的任务，但是共享同一地址空间（也就是同样的动态内存，映射文件，目标代码等），打开的文件队列和其他内核资源。

## 区别

1. 一个线程只能属于一个进程，而一个进程可以有多个线程，但至少有一个线程。线程依赖进程而存在。
2. 进程在执行过程中拥有独立的内存单元，而多个线程共享进程的内存。（资源分配给进程，同一进程下的所有线程共享该进程的所有资源。同一进程中的所有线程共享代码段（代码和常量），数据段（全局变量和静态变量），扩展段（堆存储）。但是每个线程拥有自己的栈段，栈段又叫运行时段，用来存放所有局部变量和零时变量。）
3. 进程时资源分配的最小单位，线程是 CPU 调度的最小单位。
4. 系统开销：由于在创建或撤销进程时，系统都要为之分配或回收资源，如内存空间、I/O 设备等。因此，操作系统所付出的开销将显著的大于创建或撤销线程时的开销。类似的，在进行线程切换时，涉及到整个当前进程 CPU 环境的保存以及新被调度运行的进程的 CPU 环境的设置。而线程切换只需保存和设置少量寄存器的内容，并不涉及存储器管理方面的操作。可见进程切换的开销也远大于线程切换的开销。
5. 通信：由于一个进程中的线程具有相同的地址空间，致使他们之间的同步和通信的实现也变得比较容易。进程间通信 IPC，线程可以直接读写进程数据段（如全局变量）来进行通信 - 需要进程同步和互斥手段的辅助，以保证数据的一致性。在有的系统中，线程的切换，同步和通信都无需操作系统内核的干预。
6. 进程编程调试简单可靠性高，但创建销毁开销大；但线程恰恰相反，开销小，切换速度快，但是编程调试相对复杂。
7. 进程间不会相互影响；线程一个线程挂掉会导致整个进程挂掉。
8. 进程适用于多核、多机分布；线程适用于多核。
